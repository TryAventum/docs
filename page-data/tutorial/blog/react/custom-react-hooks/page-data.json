{"componentChunkName":"component---src-templates-doc-js","path":"/tutorial/blog/react/custom-react-hooks/","result":{"data":{"mdx":{"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Custom React Hooks\",\n  \"date\": \"2020-05-10\",\n  \"order\": 81\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", null, \"What You Will Learn Regarding Aventum?\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Making a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"GET\"), \" request to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://localhost:3030/users/me\"), \" and put the access token(\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"x-access-token\"), \") in the request header will return the user's data.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Making a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"GET\"), \" request to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://localhost:3030/options/public\"), \" will return the public options like the business name, the enabled provider logins, etc.\"))), mdx(\"hr\", null), mdx(\"p\", null, \"Inside the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src\"), \" folder create the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"reactHooks\"), \" folder and inside this one create \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"useAuth.js\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"useOptions.js\"), \" files.\"), mdx(\"h2\", null, \"useAuth.js\"), mdx(\"p\", null, \"This hook will return an object with three properties \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"user\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"logout\"), \", and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"onLogin\"), \".\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"user\"), \" is the current logged in user data.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"logout\"), \" function when called will logout the current user.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"onLogin\"), \" function when called with a new user data it will update the user data.\")), mdx(\"p\", null, \"At the top of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"useAuth.js\"), \" file import the required modules:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"title=src/reactHooks/useAuth.js\",\n    \"title\": \"src/reactHooks/useAuth.js\"\n  }), \"import { useEffect, useState, useCallback } from \\\"react\\\"\\n\")), mdx(\"p\", null, \"Next create our custom hook function:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"highlight=3 title=src/reactHooks/useAuth.js\",\n    \"highlight\": \"3\",\n    \"title\": \"src/reactHooks/useAuth.js\"\n  }), \"import { useEffect, useState, useCallback } from \\\"react\\\"\\n\\nexport default () => {}\\n\")), mdx(\"p\", null, \"We will grab the user data from the local storage and we will need a state to manage the user data.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"highlight=4-7 title=src/reactHooks/useAuth.js\",\n    \"highlight\": \"4-7\",\n    \"title\": \"src/reactHooks/useAuth.js\"\n  }), \"import { useEffect, useState, useCallback } from \\\"react\\\"\\n\\nexport default () => {\\n  const localUserDate = localStorage.getItem(\\\"user-data\\\")\\n  const [user, setUser] = useState(\\n    localUserDate ? JSON.parse(localUserDate) : null\\n  )\\n}\\n\")), mdx(\"p\", null, \"Next define our \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"logout\"), \":\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"highlight=9-13 title=src/reactHooks/useAuth.js\",\n    \"highlight\": \"9-13\",\n    \"title\": \"src/reactHooks/useAuth.js\"\n  }), \"import { useEffect, useState, useCallback } from \\\"react\\\"\\n\\nexport default () => {\\n  const localUserDate = localStorage.getItem(\\\"user-data\\\")\\n  const [user, setUser] = useState(\\n    localUserDate ? JSON.parse(localUserDate) : null\\n  )\\n\\n  function logout() {\\n    localStorage.removeItem(\\\"user-data\\\")\\n    localStorage.removeItem(\\\"x-access-token\\\")\\n    setUser(null)\\n  }\\n}\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"logout\"), \" function will remove the user data from the local storage and from the memory.\"), mdx(\"p\", null, \"Next define the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"onLogin\"), \" function:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"highlight=15-17 title=src/reactHooks/useAuth.js\",\n    \"highlight\": \"15-17\",\n    \"title\": \"src/reactHooks/useAuth.js\"\n  }), \"import { useEffect, useState, useCallback } from \\\"react\\\"\\n\\nexport default () => {\\n  const localUserDate = localStorage.getItem(\\\"user-data\\\")\\n  const [user, setUser] = useState(\\n    localUserDate ? JSON.parse(localUserDate) : null\\n  )\\n\\n  function logout() {\\n    localStorage.removeItem(\\\"user-data\\\")\\n    localStorage.removeItem(\\\"x-access-token\\\")\\n    setUser(null)\\n  }\\n\\n  const onLogin = _userData => {\\n    setUser(_userData)\\n  }\\n}\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"onLogin\"), \" method will simply update the user data with a new one.\"), mdx(\"p\", null, \"Now define the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getCurrentUser\"), \" function:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"highlight=19-30 title=src/reactHooks/useAuth.js\",\n    \"highlight\": \"19-30\",\n    \"title\": \"src/reactHooks/useAuth.js\"\n  }), \"import { useEffect, useState, useCallback } from \\\"react\\\"\\n\\nexport default () => {\\n  const localUserDate = localStorage.getItem(\\\"user-data\\\")\\n  const [user, setUser] = useState(\\n    localUserDate ? JSON.parse(localUserDate) : null\\n  )\\n\\n  function logout() {\\n    localStorage.removeItem(\\\"user-data\\\")\\n    localStorage.removeItem(\\\"x-access-token\\\")\\n    setUser(null)\\n  }\\n\\n  const onLogin = _userData => {\\n    setUser(_userData)\\n  }\\n\\n  //Fetch current user\\n  const getCurrentUser = useCallback(async _p => {\\n    const response = await fetch(`http://localhost:3030/users/me`, {\\n      headers: {\\n        \\\"Content-Type\\\": \\\"application/json\\\",\\n        \\\"x-access-token\\\": localStorage.getItem(\\\"x-access-token\\\"),\\n      },\\n    })\\n    let userData = await response.json()\\n    localStorage.setItem(\\\"user-data\\\", JSON.stringify(userData))\\n    setUser(userData)\\n  }, [])\\n}\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getCurrentUser\"), \" will make a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"GET\"), \" request to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://localhost:3030/users/me\"), \" endpoint with the user token in the request's header, the server will response with the latest version of the user data, then we store this data to the local storage and update our \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"user\"), \" state.\"), mdx(\"p\", null, \"We will use the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"useEffect\"), \" React hook to fire the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getCurrentUser\"), \" function if there is a user token (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"x-access-token\"), \") in the local storage otherwise we set the current user data to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"null\"), \".\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"highlight=32-38 title=src/reactHooks/useAuth.js\",\n    \"highlight\": \"32-38\",\n    \"title\": \"src/reactHooks/useAuth.js\"\n  }), \"import { useEffect, useState, useCallback } from \\\"react\\\"\\n\\nexport default () => {\\n  const localUserDate = localStorage.getItem(\\\"user-data\\\")\\n  const [user, setUser] = useState(\\n    localUserDate ? JSON.parse(localUserDate) : null\\n  )\\n\\n  function logout() {\\n    localStorage.removeItem(\\\"user-data\\\")\\n    localStorage.removeItem(\\\"x-access-token\\\")\\n    setUser(null)\\n  }\\n\\n  const onLogin = _userData => {\\n    setUser(_userData)\\n  }\\n\\n  //Fetch current user\\n  const getCurrentUser = useCallback(async _p => {\\n    const response = await fetch(`http://localhost:3030/users/me`, {\\n      headers: {\\n        \\\"Content-Type\\\": \\\"application/json\\\",\\n        \\\"x-access-token\\\": localStorage.getItem(\\\"x-access-token\\\"),\\n      },\\n    })\\n    let userData = await response.json()\\n    localStorage.setItem(\\\"user-data\\\", JSON.stringify(userData))\\n    setUser(userData)\\n  }, [])\\n\\n  useEffect(() => {\\n    if (localStorage.getItem(\\\"x-access-token\\\")) {\\n      getCurrentUser()\\n    } else {\\n      setUser(null)\\n    }\\n  }, [getCurrentUser])\\n}\\n\")), mdx(\"p\", null, \"Finally the most important thing, what this custom hook will return:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"highlight=40 title=src/reactHooks/useAuth.js\",\n    \"highlight\": \"40\",\n    \"title\": \"src/reactHooks/useAuth.js\"\n  }), \"import { useEffect, useState, useCallback } from \\\"react\\\"\\n\\nexport default () => {\\n  const localUserDate = localStorage.getItem(\\\"user-data\\\")\\n  const [user, setUser] = useState(\\n    localUserDate ? JSON.parse(localUserDate) : null\\n  )\\n\\n  function logout() {\\n    localStorage.removeItem(\\\"user-data\\\")\\n    localStorage.removeItem(\\\"x-access-token\\\")\\n    setUser(null)\\n  }\\n\\n  const onLogin = _userData => {\\n    setUser(_userData)\\n  }\\n\\n  //Fetch current user\\n  const getCurrentUser = useCallback(async _p => {\\n    const response = await fetch(`http://localhost:3030/users/me`, {\\n      headers: {\\n        \\\"Content-Type\\\": \\\"application/json\\\",\\n        \\\"x-access-token\\\": localStorage.getItem(\\\"x-access-token\\\"),\\n      },\\n    })\\n    let userData = await response.json()\\n    localStorage.setItem(\\\"user-data\\\", JSON.stringify(userData))\\n    setUser(userData)\\n  }, [])\\n\\n  useEffect(() => {\\n    if (localStorage.getItem(\\\"x-access-token\\\")) {\\n      getCurrentUser()\\n    } else {\\n      setUser(null)\\n    }\\n  }, [getCurrentUser])\\n\\n  return { user, logout, onLogin }\\n}\\n\")), mdx(\"h2\", null, \"useOptions.js\"), mdx(\"p\", null, \"This custom hook will bring the public options(like the business name, the enabled provider logins, etc.) from the Aventum server.\"), mdx(\"p\", null, \"At the top of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"useOptions.js\"), \" file import the required modules:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"title=src/reactHooks/useOptions.js\",\n    \"title\": \"src/reactHooks/useOptions.js\"\n  }), \"import { useState, useCallback, useEffect } from \\\"react\\\"\\n\")), mdx(\"p\", null, \"Next create our custom hook function:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"highlight=3 title=src/reactHooks/useOptions.js\",\n    \"highlight\": \"3\",\n    \"title\": \"src/reactHooks/useOptions.js\"\n  }), \"import { useState, useCallback, useEffect } from \\\"react\\\"\\n\\nexport default () => {}\\n\")), mdx(\"p\", null, \"We need a single state to store the options that we receive from the server.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"highlight=4 title=src/reactHooks/useOptions.js\",\n    \"highlight\": \"4\",\n    \"title\": \"src/reactHooks/useOptions.js\"\n  }), \"import { useState, useCallback, useEffect } from \\\"react\\\"\\n\\nexport default () => {\\n  const [options, setOptions] = useState()\\n}\\n\")), mdx(\"p\", null, \"Next create \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getPublicOptions\"), \" function:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"highlight=6-11 title=src/reactHooks/useOptions.js\",\n    \"highlight\": \"6-11\",\n    \"title\": \"src/reactHooks/useOptions.js\"\n  }), \"import { useState, useCallback, useEffect } from \\\"react\\\"\\n\\nexport default () => {\\n  const [options, setOptions] = useState()\\n\\n  //Fetch public options\\n  const getPublicOptions = useCallback(async () => {\\n    const response = await fetch(`http://localhost:3030/options/public`)\\n    let data = await response.json()\\n    setOptions(data.options)\\n  }, [])\\n}\\n\")), mdx(\"p\", null, \"Our \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getPublicOptions\"), \" function will make a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"GET\"), \" request to the server to grab the public options then it stores them in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"options\"), \" state.\"), mdx(\"p\", null, \"We will fire \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getPublicOptions\"), \" function inside the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"useEffect\"), \" React hook.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"highlight=13-15 title=src/reactHooks/useOptions.js\",\n    \"highlight\": \"13-15\",\n    \"title\": \"src/reactHooks/useOptions.js\"\n  }), \"import { useState, useCallback, useEffect } from \\\"react\\\"\\n\\nexport default () => {\\n  const [options, setOptions] = useState()\\n\\n  //Fetch public options\\n  const getPublicOptions = useCallback(async () => {\\n    const response = await fetch(`http://localhost:3030/options/public`)\\n    let data = await response.json()\\n    setOptions(data.options)\\n  }, [])\\n\\n  useEffect(() => {\\n    getPublicOptions()\\n  }, [getPublicOptions])\\n}\\n\")), mdx(\"p\", null, \"Finally what our custom hook will return:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"highlight=17 title=src/reactHooks/useOptions.js\",\n    \"highlight\": \"17\",\n    \"title\": \"src/reactHooks/useOptions.js\"\n  }), \"import { useState, useCallback, useEffect } from \\\"react\\\"\\n\\nexport default () => {\\n  const [options, setOptions] = useState()\\n\\n  //Fetch public options\\n  const getPublicOptions = useCallback(async () => {\\n    const response = await fetch(`http://localhost:3030/options/public`)\\n    let data = await response.json()\\n    setOptions(data.options)\\n  }, [])\\n\\n  useEffect(() => {\\n    getPublicOptions()\\n  }, [getPublicOptions])\\n\\n  return options\\n}\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#what-you-will-learn-regarding-aventum","title":"What You Will Learn Regarding Aventum?"},{"url":"#useauthjs","title":"useAuth.js"},{"url":"#useoptionsjs","title":"useOptions.js"}]},"frontmatter":{"title":"Custom React Hooks"}}},"pageContext":{"slug":"/tutorial/blog/react/custom-react-hooks/","prev":{"fields":{"slug":"/tutorial/blog/react/registration/"},"frontmatter":{"title":"Registration"}},"next":{"fields":{"slug":"/tutorial/blog/react/app/"},"frontmatter":{"title":"App.js"}}}},"staticQueryHashes":["681094712"]}